{% extends "base.html" %}
{% load static %}

{% block title %}Login | Elevo{% endblock %}

{% block content %}
<section class="min-h-screen py-10 px-4 sm:px-6 lg:px-8 flex items-center justify-center">
  <div class="w-full max-w-5xl grid grid-cols-1 lg:grid-cols-2 gap-6">
    <div class="hidden lg:flex flex-col justify-between rounded-3xl p-8 border border-slate-700/60 bg-gradient-to-br from-slate-900/90 to-slate-800/70 backdrop-blur-xl">
      <div>
        <p class="text-xs uppercase tracking-[0.18em] text-sky-300 font-semibold mb-3">Elevo Access</p>
        <h1 class="text-4xl font-bold text-white leading-tight">Sign in and continue your interview prep flow.</h1>
        <p class="text-slate-300 mt-4 text-base leading-relaxed">Pick up coding practice, run AI interviews, and keep your learning streak active from one workspace.</p>
      </div>
      <div class="grid grid-cols-2 gap-3 mt-8">
        <div class="rounded-xl border border-sky-400/25 bg-sky-500/10 p-4">
          <p class="text-sky-200 text-xs uppercase tracking-wide">Problems</p>
          <p class="text-white text-2xl font-bold mt-1">1200+</p>
        </div>
        <div class="rounded-xl border border-emerald-400/25 bg-emerald-500/10 p-4">
          <p class="text-emerald-200 text-xs uppercase tracking-wide">Active Learners</p>
          <p class="text-white text-2xl font-bold mt-1">25K+</p>
        </div>
      </div>
    </div>

    <div class="glass-elevated rounded-3xl p-7 sm:p-9 border border-slate-700/50 bg-slate-900/90 backdrop-blur-xl">
      <div class="mb-7">
        <div class="inline-flex items-center justify-center w-12 h-12 rounded-xl bg-gradient-to-br from-sky-500 to-teal-500 mb-4 shadow-lg">
          <i class="ri-login-box-line text-white text-xl"></i>
        </div>
        <h2 class="text-3xl font-bold text-white">Welcome Back</h2>
        <p class="text-slate-400 mt-2">Use your Elevo account credentials to sign in.</p>
      </div>

      {% if messages %}
        <div class="mb-5 space-y-3">
          {% for message in messages %}
            <div class="text-sm px-4 py-3 rounded-xl border
              {% if message.tags == 'success' %}bg-emerald-500/10 text-emerald-200 border-emerald-500/30
              {% elif message.tags == 'error' %}bg-red-500/10 text-red-200 border-red-500/30
              {% elif message.tags == 'warning' %}bg-yellow-500/10 text-yellow-200 border-yellow-500/30
              {% else %}bg-sky-500/10 text-sky-200 border-sky-500/30{% endif %}">
              {{ message }}
            </div>
          {% endfor %}
        </div>
      {% endif %}

      <form method="POST" action="{% url 'login' %}" class="space-y-5" novalidate autocomplete="off">
        {% csrf_token %}
        <input type="text" name="fake_username" autocomplete="username" class="hidden" tabindex="-1" aria-hidden="true">
        <input type="password" name="fake_password" autocomplete="current-password" class="hidden" tabindex="-1" aria-hidden="true">

        {% if form.non_field_errors %}
          <div class="rounded-xl border border-red-500/30 bg-red-500/10 px-4 py-3 text-sm text-red-200">
            {% for error in form.non_field_errors %}<p>{{ error }}</p>{% endfor %}
          </div>
        {% endif %}

        <div>
          <label for="{{ form.username.id_for_label }}" class="block text-sm font-semibold text-slate-300 mb-2">Username or Email</label>
          <div class="relative">
            <i class="ri-user-line absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"></i>
            <input
              type="text"
              name="{{ form.username.name }}"
              id="{{ form.username.id_for_label }}"
              value="{{ form.username.value|default:'' }}"
              placeholder="you@example.com"
              autocomplete="off"
              autocapitalize="none"
              spellcheck="false"
              readonly
              onfocus="this.removeAttribute('readonly');"
              class="w-full pl-10 pr-4 py-3 rounded-xl border border-slate-600 bg-slate-800 text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-sky-500 focus:border-sky-500 {% if form.username.errors %}border-red-500 focus:ring-red-500{% endif %}"
              {% if form.username.field.required %}required{% endif %}
            >
          </div>
          {% for error in form.username.errors %}<p class="text-red-300 text-xs mt-2">{{ error }}</p>{% endfor %}
        </div>

        <div>
          <label for="{{ form.password.id_for_label }}" class="block text-sm font-semibold text-slate-300 mb-2">Password</label>
          <div class="relative">
            <i class="ri-lock-line absolute left-3 top-1/2 -translate-y-1/2 text-slate-500"></i>
            <input
              type="password"
              name="{{ form.password.name }}"
              id="{{ form.password.id_for_label }}"
              placeholder="Enter your password"
              autocomplete="off"
              readonly
              onfocus="this.removeAttribute('readonly');"
              class="w-full pl-10 pr-11 py-3 rounded-xl border border-slate-600 bg-slate-800 text-slate-100 placeholder:text-slate-500 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:border-teal-500 {% if form.password.errors %}border-red-500 focus:ring-red-500{% endif %}"
              {% if form.password.field.required %}required{% endif %}
            >
            <button type="button" class="absolute right-3 top-1/2 -translate-y-1/2 text-slate-400 hover:text-teal-300" onclick="togglePassword('{{ form.password.id_for_label }}')">
              <i class="ri-eye-line" id="password-toggle-icon"></i>
            </button>
          </div>
          {% for error in form.password.errors %}<p class="text-red-300 text-xs mt-2">{{ error }}</p>{% endfor %}
        </div>

        <div class="flex items-center justify-between">
          <label class="inline-flex items-center gap-2 text-sm text-slate-400">
            <input type="checkbox" name="remember_me" class="rounded border-slate-500 bg-slate-800 text-sky-500 focus:ring-sky-500">
            Remember me
          </label>
          <a href="{% url 'users:forgot_password' %}" class="text-sm font-medium text-teal-300 hover:text-teal-200">Forgot password?</a>
        </div>

        <button type="submit" class="w-full py-3 rounded-xl bg-gradient-to-r from-sky-600 to-teal-600 hover:from-sky-700 hover:to-teal-700 text-white font-semibold text-base shadow-lg transition-all">
          <span class="inline-flex items-center gap-2"><i class="ri-arrow-right-line"></i> Sign In</span>
        </button>
      </form>

      <p class="text-center text-sm text-slate-400 mt-6">
        New to Elevo?
        <a href="{% url 'users:signup' %}" class="text-sky-300 hover:text-teal-300 font-semibold">Create your account</a>
      </p>
    </div>
  </div>
</section>

<script>
function togglePassword(fieldId) {
  const passwordField = document.getElementById(fieldId);
  const toggleIcon = document.getElementById('password-toggle-icon');
  if (passwordField.type === 'password') {
    passwordField.type = 'text';
    toggleIcon.className = 'ri-eye-off-line';
  } else {
    passwordField.type = 'password';
    toggleIcon.className = 'ri-eye-line';
  }
}
</script>
{% endblock %}
